"
create table USER_BASE (
id BIGINT,
pack STRING,
vip_level STRING,
ol_days INT
)
row format delimited fields terminated by '\t';
"

"
create table USER_CALL_DETAIL (
id BIGINT,
object BIGINT,
time BIGINT,
out BOOLEAN,
duration INT,
location STRING
)
row format delimited fields terminated by '\t';
"

"
create  table USER_TEXT_DETAIL (
id BIGINT,
time BIGINT,
out BOOLEAN,
location STRING,
content STRING
)
row format delimited fields terminated by '\t';
"

"
create table net_detail (
frist_level STRING ,
second_level STRING,
client STRING,
up_flow BIGINT,
down_flow BIGINT,
total_flow BIGINT,
total_time BIGINT,
total_count INT,
provice_id INT,
user_id BIGINT,
business_type STRING
)
row format delimited fields terminated by ',';
"

"
create external table USER_CONSUME_DETAIL (
id BIGINT,
time BIGINT,
consume MAP<STRING,FLOAT>
)
row format delimited fields terminated by '\t' COLLECTION ITEMS TERMINATED BY ',' MAP KEYS TERMINATED BY ':';
"

"
create table CALL_RECORD (
from_id BIGINT,
to_id BIGINT,
time BIGINT,
duration INT,
send_location INT,
receive_location INT
)
row format delimited fields terminated by '\t';
"

load data local inpath '/Data/boraydata/DataNet/netdata' into table net_detail;

 create table user_interest as
 select province_id,user_id,item_code,item_name,
 total_flow,total_count,total_time,up_flow,down_flow,
 client_type, busi_type from net_detail where user_id is not null
 order by user_id,total_flow desc;



 create table interest_relate_user as
 select item_code,item_name,province_id,user_id,
 total_flow,total_count,total_time,up_flow,down_flow,
 client_type, busi_type from net_detail where user_id is not null
 order by item_code,total_flow desc,total_count desc;